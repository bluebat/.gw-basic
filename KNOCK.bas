10 '**********************
20 '*                    *
30 '*        KNOCK       *
40 '*                    *
50 '*        J.W.L       *
60 '*                    *
70 '**********************
80 GOSUB 140 'Prepare
90 GOSUB 240 'Draw Stage
100 GOSUB 280 'Draw Ball
110 GOSUB 380 'Change Degrees
120 GOSUB 570 'Knock Ball
130 '
140 CLS
150 KEY OFF
160 PRINT"How many balls are there except WHITE ball?":BN$=INPUT$(1):BN=VAL(BN$)
170 PRINT
180 PRINT"Press  [+] to + or  [-] to -"
190 PRINT
200 PRINT"Press [*] let ANGLE CHANGE=5 , [.] =1 , [/] =180"
210 PI=3.14159:R(1)=15:R(2)=100:SA=5
220 RETURN
230 '
240 DRAW"C1 BM60,100 D200 R600 U200 L600"
250 CIRCLE(60,100),20,,0,1.5*PI,.66 : CIRCLE(60,300),20,,PI/2,0,.66:                CIRCLE(660,100),20,,1.5*PI,PI,.66  : CIRCLE(660,300),20,,PI,PI/2,.66:           CIRCLE(360,100),20,,0,PI,.66 : CIRCLE(360,300),20,,PI,0,.66
260 RETURN
270 '
280 RANDOMIZE VAL(RIGHT$(TIME$,2))
290 FOR K=0 TO BN
300 BX(K)=RND*620 : IF BX(K)<100 THEN 300
310 BY(K)=RND*270 : IF BY(K)<130 THEN 310
320 CIRCLE(BX(K),BY(K)),10,,,,.66
330 NEXT K
340 BX=BX(0) : BY=BY(0)
350 PAINT(BX,BY),1
360 RETURN
370 '
380 GOSUB 240
390 GOTO 500
400 V$=INPUT$(1)
410 IF V$=" " THEN J=0 : RETURN
420 IF V$="+" THEN CA=SA
430 IF V$="-" THEN CA=-SA
440 IF V$="/" THEN CA=180
450 IF V$="*" THEN SA=5
460 IF V$="." THEN SA=1
470 A=A+CA
480 IF ABS(A)>360 THEN A=ABS(A)-360
490 LINE(XF(1),YF(1))-(XF(2),YF(2)),0:LINE -(XL(2),YL(2)),0:                        LINE -(XL(1),YL(1)),0:LINE -(XF(1),YF(1)),0
500 FOR K=1 TO 2
510 XF(K)=BX(0)+R(K)*COS((A+1)/180*PI):YF(K)=BY(0)-R(K)*SIN((A+1)/180*PI)
520 XL(K)=BX(0)+R(K)*COS((A-1)/180*PI):YL(K)=BY(0)-R(K)*SIN((A-1)/180*PI)
530 NEXT K
540 LINE(XF(1),YF(1))-(XF(2),YF(2)):LINE -(XL(2),YL(2)):LINE -(XL(1),YL(1)):        LINE -(XF(1),YF(1))
550 GOTO 400
560 '
570 LINE(XF(1),YF(1))-(XF(2),YF(2)),0:LINE -(XL(2),YL(2)),0:                        LINE -(XL(1),YL(1)),0:LINE -(XF(1),YF(1)),0
580 I=50
590 STEPS=I
600 BX(B)=BX : BY(B)=BY
610 B=J
620 BX=BX(B) : BY=BY(B) : BOX=BX(0) : BOY=BY(0)
630 SOUND 1000,3
640 FOR I=STEPS TO 0 STEP -2
650  CIRCLE(BX,BY),10,0,,,.66
660  PAINT (BX,BY),0
670  BX=BX+I*COS(A/180*PI+PI) : BY=BY-I*SIN(A/180*PI+PI)
680  IF BX<70 OR BX>650 THEN A=180-A : SOUND 200,3 : GOTO 780
690  IF BY<110 OR BY>290 THEN A=-A : SOUND 200,3 : GOTO 780
700  CIRCLE(BX,BY),10,,,,.66
710  PAINT (BX,BY),1-SGN(B)
720  FOR J=0 TO BN
730   IF J=B THEN 770
740   BOX=BX(J) : BOY=BY(J)
750   D=SQR((BX-BOX)*(BX-BOX)+(BY-BOY)*(BY-BOY))
760 IF D<23 THEN A=ATN((BOY-BY)/(BX-BOX))*PI/180 : GOTO 590
770  NEXT J
780 NEXT I
790 BX(B)=BX : BY(B)=BY
800 RETURN 110
