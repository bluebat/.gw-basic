10 '********************************
20 '*                              *
30 '*           ERAD  CODE         *
40 '*                              *
50 '*             J.W.L            *
60 '*                              *
70 '********************************
80 KEY OFF : CLS
90 DEF FNC=ASC(CODE$)
100 CARRAGE=14
110 CLOSE
120 ON ERROR GOTO 810
130 ON KEY(11) GOSUB 850
140 ON KEY(14) GOSUB 880
150 KEY(11) ON
160 KEY(14) ON
170 '
180 INPUT "file name ";FILE$
190 OPEN FILE$ AS #1 LEN=1
200 FIELD #1,1 AS CODE$
210 LENGTH=LOF(1)
220 PRINT:INPUT "begin from ? (1) ",N
230 IF N=0 THEN N=1
240 PRINT:INPUT "steps for a jump ? (1) ",JUMP
250 IF JUMP=0 THEN JUMP=1
260 '
270 PRINT:PRINT"[0] only letter   [1] add   [2] swap   [3] logo   [4] end";
280 W=VAL(INPUT$(1))
290 PRINT:PRINT
300 IF W=0 OR W=4 THEN 340
310 INPUT " carriage return ?(Y/N) ",Z$
320 IF Z$="Y" OR Z$="y" THEN CARRAGE=13
330 '
340 ON W GOTO 360,370,380,920
350 GOTO 390
360 INPUT "AddCode --  ",ADDCODE : GOTO 390
370 '
380 '
390 '
400 '==== main loop ====
410 GOSUB 740  'input #1
420 GOSUB 470  'change
430 'IF EOF(1) THEN 390 ELSE 50
440 GOTO 410
450 '===================
460 '
470 '**** change
480 ON W GOTO 530,570,630
490 '
500 IF C0>31 AND C0<128 THEN C=C0 : GOSUB 680
510 RETURN
520 '
530 C=C0+ADDCODE
540 GOSUB 680
550 RETURN
560 '
570 C1=C0
580 GOSUB 740
590 C=C0 : GOSUB 680
600 C=C1 : GOSUB 680
610 RETURN
620 '
630 IF C0=2 THEN C=13 : GOSUB 680 ELSE RETURN
640 N=N+3
650 GOSUB 740:GOSUB 560
660 IF C0>31 AND C0<128 THEN 650 ELSE RETURN
670 '
680 '**** print
690 IF (C>6 AND C<CARRAGE) OR (C>27 AND C<32) THEN C=32
700 IF C<1 OR C>255 THEN C=32
710 PRINT CHR$(C);
720 RETURN
730 '
740 '**** get #1
750 IF N<LENGTH THEN GET #1,N ELSE 930
760 N=N+1
770 IF CODE$="" THEN CODE$=" "
780 C0=FNC
790 RETURN
800 '
810 '**** error
820 IF ERR=62 THEN SOUND 575,3:BEEP:N=N+1:RESUME
830 ON ERROR GOTO 0
840 '
850 '**** jump
860 N=N+JUMP
870 RETURN
880 '**** number
890 ROW=CSRLIN : COL=POS(0)
900 LOCATE 25,1 : PRINT N : LOCATE ROW-1,COL
910 RETURN
920 '
930 ON ERROR GOTO 0
940 KEY ON  : KEY(14) OFF : KEY(11) OFF
950 END
