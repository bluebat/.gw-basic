10 PI=3.1415926#
20 R=50 : NL=10 : S=30 : NR=INT(R/5)  '200,20,15,10
30 DL=PI/NL : DR=PI/NR : S=PI*S/180
40 CS=COS(S) : SS=SIN(S)
50 CLS : KEY OFF
60 CIRCLE(360,173),R
70 FOR I=1 TO NL-1
80   A=DL*I : N=INT(NR-ABS(.5-I/NL)*NR) : DD=PI/N
90   FOR J=0 TO N
100     B=DD*J : GOSUB 190
110 NEXT J,I
120 FOR I=NL TO 0 STEP -1
130   B=DL*I
140   FOR J=0 TO NR
150     A=DR*J : GOSUB 190
160 NEXT J,I
170 END
180 '---------------------------------------------------
190 SA=R*SIN(A) : X=SA*COS(B) : Y=SA*SIN(B) : Z=R*COS(A)
200 IF Z*CS+X*SS<0 THEN J=NR : RETURN
210 H=360 +Y : V=173-(Z*SS-X*CS)/1.5 : H1=720-H : V1=V
220 IF J>0 THEN LINE -(H,V) ELSE PSET(H,V) : GOTO 240
230 LINE(H2,V2)-(H1,V1) : PSET(H,V)
240 H2=H1 : V2=V1 : RETURN
